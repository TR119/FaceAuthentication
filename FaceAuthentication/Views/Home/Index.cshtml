@{
    Layout = null;
    string tfjsUrl = "https://cdn.jsdelivr.net/npm/@tensorflow/tfjs";
    string facemeshUrl = "https://cdn.jsdelivr.net/npm/@tensorflow-models/facemesh";
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - My ASP.NET Application</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.min.js" integrity="sha512-ykZ1QQr0Jy/4ZkvKuqWn4iF3lqPZyij9iRv6sGqLRdTPkY69YX6+7wvVGmsdBbiIfN/8OdsI7HABjvEok6ZopQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="@Html.Raw(tfjsUrl)"></script>
    <script src="@Html.Raw(facemeshUrl)"></script>
    <link rel="stylesheet" href="~/Content/FaceRecongnition/faceRecognition.css"/>
</head>
<body>
    <div class="body-content">
        @if (ViewBag.IsMobile)
        {
            <div id="container-mobile">
                <input type="hidden" id="IsMobile" value="1" />
                <div class="d-flex justify-content-center " style="width:100%;">
                    <div style="width: 100%; ">
                        <div class="camera-wrap">
                            <!-- Your camera feed element -->
                            <video id="camera" class="animate__flipInX" autoplay muted playsinline></video>
                            <canvas id="canvas" style="display: none;"></canvas>
                            <div class="result-div d-none">
                                <div class="result-item">
                                </div>

                            </div>
                            <!-- Overlay for instructions -->
                            <div id="overlayText" class="">
                                <div id="instruction-text">Đưa khuôn mặt vào giữ khung hình</div>
                            </div>

                            <!--SVG container-->
                            <div id="svg-container">
                                <svg id="custom-svg" class="WebcamCapture_ellipse__4o13l" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" viewBox="0 0 400 542" rotate="100deg" action="0">
                                    <defs>
                                        <mask id="bgClip">
                                            <rect x="0" y="0" width="400" height="542" fill="#fff" />
                                            <ellipse cx="200" cy="271" rx="122" ry="122" />
                                        </mask>
                                        <mask id="readinessMask" x="0" y="0">
                                            <circle fill="white" r="0" cx="200" cy="271" />
                                            <ellipse cx="200" cy="271" rx="122" ry="122" />
                                        </mask>
                                        <mask id="ovalClip">
                                            <rect x="0" y="0" width="400" height="542" fill="#fff" />
                                        </mask>
                                    </defs>
                                    <rect mask="url(#bgClip)" x="0" y="0" width="400" height="542" fill="rgba(255,255,255,1)" />
                                    <defs>
                                        <mask id="targetSectorMask" x="0" y="0">
                                            <circle stroke-width="62.5" r="125" cx="200" cy="271" fill="" stroke="white" />
                                            <ellipse cx="200" cy="271" rx="122" ry="122" />
                                        </mask>
                                    </defs>
                                    <ellipse mask="url(#ovalClip)" id="animated-ellipse" class=" " cx="200" cy="271" rx="132" ry="132" fill="none" stroke-dasharray="3 5" stroke="#ccc" stroke-width="12" />
                                    <ellipse mask="url(#ovalClip)" class="circle" cx="200" cy="271" rx="124" ry="124" fill="none" stroke="#04a537" stroke-width="4" stroke-dasharray="800" stroke-dashoffset="780" />
                                </svg>
                            </div>
                        </div>
                        <div class="d-flex justify-content-center mt-3">
                            <button class="btn btn-ui btnReTry shadow d-none" onclick="handleCapture()">Thử lại</button>
                        </div>
                    </div>

                </div>
            </div>

        }
        else
        {
            <div id="container-pc">
                <input type="hidden" id="IsMobile" value="0" />
                @*<div class="entry-screen">
                        <p class="text-white text-center spinner-text"></p>
                        <div class="spinner"></div>
                    </div>*@
                <div class="d-flex justify-content-center align-items-center faceCheck-container">
                    <div style="min-height:416px;">
                        <div class="camera-wrap">
                            <div class="d-flex" style="height:360px;">
                                <video id="camera" autoplay muted playsinline></video>
                                <canvas id="canvas" class="d-none"></canvas>
                                <div class="result-div d-none">
                                    <div class="result-item">
                                    </div>

                                </div>
                            </div>
                            <div class="w-100 d-flex justify-content-center bg-dark">
                                <img id="imageUpload" src="" class="d-none" />
                            </div>

                            <div id="overlayText">
                                <div id="instruction-text">Để khuôn mặt vào giữa khung hình</div>
                            </div>

                            <div id="svg-container">
                                <svg id="custom-svg" class="WebcamCapture_ellipse__4o13l" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" viewBox="0 0 640 360" rotate="100deg" action="0" style="position: absolute; top: 0px; left: 0px;">
                                    <defs>
                                        <mask id="bgClip">
                                            <rect x="0" y="0" width="640" height="360" fill="#fff" />
                                            <ellipse cx="320" cy="180" rx="122" ry="122" />
                                        </mask>
                                        <mask id="readinessMask" x="0" y="0">
                                            <circle fill="white" r="0" cx="320" cy="180" />
                                            <ellipse cx="320" cy="180" rx="122" ry="122" />
                                        </mask>
                                        <mask id="ovalClip">
                                            <rect x="0" y="0" width="640" height="360" fill="#fff" />
                                        </mask>
                                    </defs>
                                    <rect mask="url(#bgClip)" x="0" y="0" width="640" height="360" fill="rgb(0,0,0,0.8)" />
                                    <defs>
                                        <mask id="targetSectorMask" x="0" y="0">
                                            <circle stroke-width="62.5" r="125" cx="320" cy="180" fill="" stroke="white" />
                                            <ellipse cx="320" cy="180" rx="126" ry="126" />
                                        </mask>
                                    </defs>
                                    <ellipse mask="url(#ovalClip)" id="animated-ellipse" class=" " cx="320" cy="180" rx="132" ry="132" fill="none" stroke-dasharray="3 5" stroke="#BFBFBF" stroke-width="8" />
                                    <ellipse mask="url(#ovalClip)" class="circle" cx="320" cy="180" rx="126" ry="126" fill="none" stroke="var(--color-main)" stroke-width="5" stroke-dasharray="800" stroke-dashoffset="800" />
                                </svg>
                            </div>
                        </div>
                        <div class="d-flex justify-content-center mt-3">
                            <button class="btn btn-ui btnReTry shadow d-none" onclick="handleCapture()">Thử lại</button>
                        </div>
                    </div>

                </div>

            </div>
        }
    </div>

    @Scripts.Render("~/bundles/jquery")

    <script src="~/Content/FaceRecongnition/faceCheck.js"></script>
    <script>
        $(document).ready(function () {
             var isMobile = @Html.Raw(Json.Encode(ViewBag.IsMobile));
            $('.body-content').facerecognize({ isMobile: isMobile });
        });
    </script>
</body>
</html>








